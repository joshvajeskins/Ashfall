# Prompt 6: Sound Effects & Music

## Goal
Add audio feedback for game actions including attacks, pickups, victory, and death.

## Pre-Check: Review Issues
Before starting, check these issue docs:
- `docs/issues/ui/README.md` - Audio loading issues

## Context
`SoundManager.ts` exists and is called throughout the game:
- `soundManager.play('attack')` in CombatScene
- `soundManager.play('itemPickup')` in DungeonScene
- `soundManager.play('playerDeath')` in DeathScene
- `soundManager.play('victory')` in VictoryScene

But no actual audio files exist.

## Tasks

### 6.1 Create Audio Directory

```
frontend/public/assets/audio/
├── sfx/
│   ├── attack.mp3          # Sword swing
│   ├── hit.mp3             # Enemy takes damage
│   ├── critical.mp3        # Critical hit
│   ├── player-hurt.mp3     # Player takes damage
│   ├── player-death.mp3    # Death sound
│   ├── enemy-death.mp3     # Enemy dies
│   ├── item-pickup.mp3     # Item collected
│   ├── level-up.mp3        # Level up fanfare
│   ├── door-open.mp3       # Room transition
│   ├── button-click.mp3    # UI button
│   ├── menu-open.mp3       # Menu appears
│   ├── flee.mp3            # Escape sound
│   ├── error.mp3           # Failed action
│   └── victory.mp3         # Dungeon cleared
├── music/
│   ├── menu.mp3            # Main menu theme
│   ├── dungeon.mp3         # Dungeon exploration
│   ├── combat.mp3          # Battle music
│   └── boss.mp3            # Boss fight theme
```

### 6.2 Audio Sources

**Free Sound Libraries:**
- freesound.org (CC licensed)
- opengameart.org/content/type/music
- kenney.nl/assets?q=audio
- incompetech.com (royalty-free music)

**AI Generated:**
- Suno.ai for music
- ElevenLabs for sound effects

### 6.3 Update SoundManager

The current `SoundManager.ts` needs actual implementation:

```typescript
// game/effects/SoundManager.ts
class SoundManager {
  private scene: Phaser.Scene | null = null;
  private sounds: Map<string, Phaser.Sound.BaseSound> = new Map();
  private musicVolume = 0.3;
  private sfxVolume = 0.5;
  private isMuted = false;

  init(scene: Phaser.Scene): void {
    this.scene = scene;
    this.loadSounds();
  }

  private loadSounds(): void {
    if (!this.scene) return;

    // SFX
    const sfxKeys = [
      'attack', 'hit', 'critical', 'player-hurt', 'player-death',
      'enemy-death', 'item-pickup', 'level-up', 'door-open',
      'button-click', 'menu-open', 'flee', 'error', 'victory'
    ];

    sfxKeys.forEach(key => {
      if (this.scene!.cache.audio.exists(key)) {
        this.sounds.set(key, this.scene!.sound.add(key, { volume: this.sfxVolume }));
      }
    });
  }

  play(key: string): void {
    if (this.isMuted) return;
    const sound = this.sounds.get(key);
    if (sound) {
      sound.play();
    }
  }

  setMuted(muted: boolean): void {
    this.isMuted = muted;
  }
}

export const soundManager = new SoundManager();
```

### 6.4 Load Audio in BootScene

```typescript
private loadAssets(): void {
  // ... sprite loading

  // SFX
  this.load.audio('attack', '/assets/audio/sfx/attack.mp3');
  this.load.audio('hit', '/assets/audio/sfx/hit.mp3');
  this.load.audio('critical', '/assets/audio/sfx/critical.mp3');
  this.load.audio('player-hurt', '/assets/audio/sfx/player-hurt.mp3');
  this.load.audio('playerDeath', '/assets/audio/sfx/player-death.mp3');
  this.load.audio('enemyDeath', '/assets/audio/sfx/enemy-death.mp3');
  this.load.audio('itemPickup', '/assets/audio/sfx/item-pickup.mp3');
  this.load.audio('levelUp', '/assets/audio/sfx/level-up.mp3');
  this.load.audio('doorOpen', '/assets/audio/sfx/door-open.mp3');
  this.load.audio('buttonClick', '/assets/audio/sfx/button-click.mp3');
  this.load.audio('menuOpen', '/assets/audio/sfx/menu-open.mp3');
  this.load.audio('flee', '/assets/audio/sfx/flee.mp3');
  this.load.audio('error', '/assets/audio/sfx/error.mp3');
  this.load.audio('victory', '/assets/audio/sfx/victory.mp3');

  // Music
  this.load.audio('music-menu', '/assets/audio/music/menu.mp3');
  this.load.audio('music-dungeon', '/assets/audio/music/dungeon.mp3');
  this.load.audio('music-combat', '/assets/audio/music/combat.mp3');
  this.load.audio('music-boss', '/assets/audio/music/boss.mp3');
}
```

### 6.5 Initialize SoundManager in Scenes

Each scene's `create()` should init sound manager:

```typescript
create(): void {
  soundManager.init(this);
  // ... rest of create
}
```

### 6.6 Add Mute Toggle UI

Add mute button to Header component:

```typescript
const [isMuted, setIsMuted] = useState(false);

const toggleMute = () => {
  setIsMuted(!isMuted);
  soundManager.setMuted(!isMuted);
};
```

## Acceptance Criteria
- [ ] Attack sounds play during combat
- [ ] Item pickup has audio feedback
- [ ] Death and victory have distinct sounds
- [ ] UI interactions have click sounds
- [ ] Mute toggle works
- [ ] No console errors about missing audio

## Optional: Background Music

If time permits:
- Looping dungeon ambient music
- Combat music during battles
- Victory fanfare
- Boss theme

## Next Prompt
Prompt 7 will do end-to-end testing and bug fixes.
